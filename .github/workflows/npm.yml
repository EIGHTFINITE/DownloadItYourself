name: npm

on: [push, pull_request]

env:
  CI: true

jobs:
  test:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest]
    steps:
    - uses: actions/checkout@master
      with:
        fetch-depth: 1
    - name: npm install (ubuntu-latest)
      if: matrix.os == 'ubuntu-latest'
      run: |
        docs/scripts/configure-git.sh
        bin/linux/x64/node/node-v12.10.0-linux-x64/bin/node bin/linux/x64/node/node-v12.10.0-linux-x64/lib/node_modules/npm/bin/npm-cli.js install --no-optional --no-bin-links --loglevel=error
    - name: npm install (windows-latest)
      if: matrix.os == 'windows-latest'
      run: |
        docs\scripts\configure-git.bat
        cmd /c bin\windows\x64\node\node-v12.10.0-win-x64\npm install --no-optional --no-bin-links --loglevel=error
